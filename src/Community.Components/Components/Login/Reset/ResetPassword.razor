@namespace FluentUI.Blazor.Community.Components
@inherits FluentComponentBase

@if (Parent is not null)
{
    <LoginCardContainer Title="@Parent.Labels.ResetPassword"
                        TitleIcon="@(new Regular.Size48.LockClosed())">
        <Body>

            <FluentStack Orientation="Orientation.Vertical"
                         VerticalGap="30"
                         Style="height: 100%">
                <FluentEditForm style="width: 100%; height: 100%"
                                OnValidSubmit="@OnResetPasswordAsync"
                                method="post"
                                Model="@_model">
                    <Microsoft.AspNetCore.Components.Forms.DataAnnotationsValidator />

                    <FluentStack Orientation="Orientation.Vertical"
                                 VerticalGap="0"
                                 Style="height: 100%">
                        <input type="hidden" name="_model.Code" value="@_model.Code" />

                        <FluentStack Orientation="Orientation.Vertical"
                                     VerticalGap="0"
                                     Style="margin-bottom: 30px;">
                            <FluentTextField Label="@Parent.Labels.Email"
                                             AriaLabel="@Parent.Labels.Email"
                                             Required
                                             @bind-Value="_model.Email"
                                             Placeholder="@Parent.Labels.EmailPlaceholder"
                                             Style="width: 100%;" />

                            <FluentValidationMessage For="@(() => _model.Email)" />
                        </FluentStack>

                        <FluentStack Orientation="Orientation.Vertical"
                                     VerticalGap="0"
                                     Style="margin-bottom: 30px;">
                            <FluentTextField Label="@Parent.Labels.Password"
                                             AriaLabel="@Parent.Labels.Password"
                                             Required
                                             TextFieldType="TextFieldType.Password"
                                             @bind-Value="_model.Password"
                                             Placeholder="@Parent.Labels.PasswordPlaceholder"
                                             Style="width: 100%;" />

                            <FluentValidationMessage For="@(() => _model.Password)" />
                        </FluentStack>

                        <FluentStack Orientation="Orientation.Vertical"
                                     VerticalGap="0"
                                     Style="margin-bottom: 30px;">
                            <FluentTextField Label="@Parent.Labels.ConfirmPassword"
                                             AriaLabel="@Parent.Labels.ConfirmPassword"
                                             Required
                                             TextFieldType="TextFieldType.Password"
                                             @bind-Value="_model.ConfirmPassword"
                                             Placeholder="@Parent.Labels.ConfirmPasswordPlaceholder"
                                             Style="width: 100%;" />

                            <FluentValidationMessage For="@(() => _model.ConfirmPassword)" />
                        </FluentStack>

                        @if (_errors.Count > 0)
                        {
                            <FluentStack HorizontalGap="20" Orientation="Orientation.Horizontal">
                                <FluentIcon Value="@(new Microsoft.FluentUI.AspNetCore.Components.Icons.Regular.Size20.ErrorCircle())" />
                                <FluentLabel Color="Color.Accent">@Parent.Labels.ResetPasswordError</FluentLabel>
                            </FluentStack>

                            <FluentStack Orientation="Orientation.Vertical"
                                         VerticalGap="0"
                                         Style="overflow-y: auto">
                                @foreach (var error in _errors)
                                {
                                    <FluentLabel Color="Color.Accent">@error</FluentLabel>
                                }
                            </FluentStack>
                        }

                        <FluentStack Style="height: 100%"
                                     VerticalAlignment="VerticalAlignment.Bottom"
                                     HorizontalAlignment="HorizontalAlignment.Center">
                            <FluentButton Style="width: 100%;"
                                          Appearance="Appearance.Accent"
                                          Disabled="@_isProcessing"
                                          Type="ButtonType.Submit">
                                @Parent.Labels.Reset
                            </FluentButton>
                        </FluentStack>
                    </FluentStack>
                </FluentEditForm>
            </FluentStack>
        </Body>
    </LoginCardContainer>
}
